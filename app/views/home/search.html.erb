
<!-- ng-controller="SearchCtrl" not required if you have routing enabled-->
<% meta :title => "Lorious | Search for Experts" %>
<div ng-app='search' class='container-search wrapper' >
	<div ng-controller="SearchCtrl" class='row'>
		
			<div class="col-xs-4" >
				<br />
				<h3>Search:</h3>
				<div class="input-group merged">
				    <span class="input-group-addon"><i class="icon-search"></i></span>
				    <input ng-init="query.$=default_keyword" type="text" class="form-control searchbox" placeholder="Keyword" ng-model="query.$" />
				</div>
				
				<h3>TAG:</h3>

				<div class="input-group merged">
				    <span class="input-group-addon"><i class="icon-search"></i></span>
					<select chosen multiple class="form-control" style="width: 100%;"
			          data-placeholder="TAG"
			          no-results-text="'Could not find TAG'"
			          ng-model="selectedTags" 
        			  ng-options="f.tag for f in model.facets">
				 	</select>
				</div>
				
				<h3>Location:</h3>
				
				<link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500">
			    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places"></script>
			    <script>
					var placeSearch, autocomplete;
					window.onload= function initialize() {
					  // Create the autocomplete object, restricting the search
					  // to geographical location types.
					  autocomplete = new google.maps.places.Autocomplete(
					      /** @type {HTMLInputElement} */(document.getElementById('autocomplete')),
					      { types: ['(cities)']/*, componentRestrictions: {country: "us"} */});
					  // When the user selects an address from the dropdown,
					  // populate the address fields in the form.
					  google.maps.event.addListener(autocomplete, 'place_changed', function() {
					    try{
						   	angular.element(document.getElementById('AngularCtrl')).scope().$apply(function(scope){
						   		scope.query.location = autocomplete.getPlace().formatted_address;
						        scope.getFilteredValues();
						    });
						}
						catch(e){
							//do nothing
						}
					  });
					}
					function geolocate() {
					  if (navigator.geolocation) {
					    navigator.geolocation.getCurrentPosition(function(position) {
					      var geolocation = new google.maps.LatLng(
					          position.coords.latitude, position.coords.longitude);
					      autocomplete.setBounds(new google.maps.LatLngBounds(geolocation,
					          geolocation));
					    });
					  }
					}
				</script>
				<div class="input-group merged">
				    <span class="input-group-addon"><i class="icon-search"></i></span>
				    <input id="autocomplete" type="text" onFocus="geolocate()" class="form-control locationbox" placeholder="Location" ng-model="query.location" />
				</div>
				
				<h3>Price/Hr.</h3>
				<div ng-init="slider=[0,2000]" ui-slider="{range: true}" style="margin-left:5%; width: 50%;" min="0" max="2000" step="50" use-decimals ng-model="slider"></div>		
				
				<h5 class="text-left">Between $ {{slider[0] }} & {{slider[1] }} </h5>
				
				<h3>Rating:</h3>
				
				&nbsp;&nbsp;&nbsp;<input type="checkbox" ng-model="ratings.five"><rating value="5" max="max" readonly="isReadonly" on-hover="hoveringOver(value)" on-leave="overStar = null"></rating></input><br />
				&nbsp;&nbsp;&nbsp;<input type="checkbox" ng-model="ratings.four"><rating value="4" max="max" readonly="isReadonly" on-hover="hoveringOver(value)" on-leave="overStar = null"></rating></input><br />
				&nbsp;&nbsp;&nbsp;<input type="checkbox" ng-model="ratings.three"><rating value="3" max="max" readonly="isReadonly" on-hover="hoveringOver(value)" on-leave="overStar = null"></rating></input><br />
				&nbsp;&nbsp;&nbsp;<input type="checkbox" ng-model="ratings.two"><rating value="2" max="max" readonly="isReadonly" on-hover="hoveringOver(value)" on-leave="overStar = null"></rating></input><br />
				&nbsp;&nbsp;&nbsp;<input type="checkbox" ng-model="ratings.one"><rating value="1" max="max" readonly="isReadonly" on-hover="hoveringOver(value)" on-leave="overStar = null"></rating></input><br />
				
				<br />
				<br />
				<br />
				
			</div>
			<div class="col-xs-8">
				<ng:include src="'<%= asset_path("search-list.html") %>'"></ng:include>
			</div>
		
	</div>
</div>

